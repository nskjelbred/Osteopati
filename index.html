<!DOCTYPE html>
<html lang="nn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Osteopati Skjelbred ‚Äì Biodynamisk osteopati i Lillesand</title>

  <meta name="description" content="Osteopati i Lillesand. Biodynamisk osteopati og Barneosteopati ‚Äì behandling tilpassa deg. Ivar Otto Skjelbred, Osteopat D.O." />
  <meta name="color-scheme" content="light dark" />

  <!-- Open Graph -->
  <meta property="og:title" content="Osteopati Skjelbred ‚Äì Biodynamisk osteopati i Lillesand" />
  <meta property="og:description" content="Biodynamisk osteopati og Barneosteopati ‚Äì behandling tilpassa deg." />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="nn_NO" />
  <meta property="og:image" content="logo.gif" />

  <link rel="icon" href="logo.gif" type="image/gif" />
  <link rel="preconnect" href="https://www.google.com" />
  <link rel="preconnect" href="https://upload.wikimedia.org" />

  <!-- JSON-LD structured data for local business -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org", 
    "@type": "HealthBusiness",
    "name": "Osteopati Skjelbred",
    "description": "Biodynamisk osteopati og Barneosteopati i Lillesand",
    "url": "https://osteopatiskjelbred.no",
    "telephone": "+4798836655",
    "email": "osteopatiskjelbred@proton.me",
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "Sangereidlia 78",
      "postalCode": "4790",
      "addressLocality": "Lillesand",
      "addressCountry": "NO"
    },
    "founder": {
      "@type": "Person",
      "name": "Ivar Otto Skjelbred",
      "jobTitle": "Osteopat D.O."
    }
  }
  </script>

  <style>
    /* === Reset === */
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    img { max-width: 100%; height: auto; display: block; }
    a { color: inherit; }
    html, body { height: 100%; }
    html { scroll-behavior: smooth; }

    :root {
      --bg: #f6f9ff;
      --surface: #ffffff;
      --surface-2: #f2f6ff;
      --text: #0b2b4b;
      --muted: #4b647a;
      --border: rgba(3, 57, 108, 0.12);

      --primary: #0b74d1;
      --primary-hover: #085ea9;

      --success: #2eaa5f;
      --success-hover: #249452;

      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.06);
      --shadow-md: 0 10px 25px rgba(0, 0, 0, 0.08);

      --radius: 16px;
      --container: 980px;
      --menu-h: 84px;
      --topbar-bg: rgba(255, 255, 255, 0.72);
      --nav-bg: rgba(255, 255, 255, 0.55);
      --footer-bg: rgba(255, 255, 255, 0.65);
    }

    /* Dark theme via attribute */
    [data-theme="dark"] {
      --bg: #0f1115;
      --surface: #161a22;
      --surface-2: #0f141c;
      --text: #f3f6fb;
      --muted: #b7c3d0;
      --border: rgba(255, 255, 255, 0.10);

      --primary: #4aa3ff;
      --primary-hover: #2d8ef5;

      --success: #43c37a;
      --success-hover: #2faa63;

      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.25);
      --shadow-md: 0 12px 28px rgba(0, 0, 0, 0.35);

      --topbar-bg: rgba(22, 26, 34, 0.70);
      --nav-bg: rgba(22, 26, 34, 0.55);
      --footer-bg: rgba(22, 26, 34, 0.62);
    }

    /* Dark theme via system preference (before JS loads) */
    @media (prefers-color-scheme: dark) {
      :root:not([data-theme="light"]) {
        --bg: #0f1115;
        --surface: #161a22;
        --surface-2: #0f141c;
        --text: #f3f6fb;
        --muted: #b7c3d0;
        --border: rgba(255, 255, 255, 0.10);

        --primary: #4aa3ff;
        --primary-hover: #2d8ef5;

        --success: #43c37a;
        --success-hover: #2faa63;

        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.25);
        --shadow-md: 0 12px 28px rgba(0, 0, 0, 0.35);

        --topbar-bg: rgba(22, 26, 34, 0.70);
        --nav-bg: rgba(22, 26, 34, 0.55);
        --footer-bg: rgba(22, 26, 34, 0.62);
      }
    }

    body {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", sans-serif;
      background:
        radial-gradient(900px 500px at 20% 10%, rgba(11, 116, 209, 0.10), transparent 55%),
        radial-gradient(700px 450px at 80% 0%, rgba(46, 170, 95, 0.10), transparent 55%),
        var(--bg);
      color: var(--text);
      line-height: 1.55;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
      transition: background-color 0.25s ease, color 0.25s ease;
      color-scheme: light dark;
      display: flex;
      flex-direction: column;
      min-height: 100%;
    }

    /* === Skip link (accessibility) === */
    .skip-link {
      position: absolute;
      top: -100%;
      left: 16px;
      z-index: 100;
      padding: 10px 18px;
      background: var(--primary);
      color: #fff;
      border-radius: 0 0 12px 12px;
      font-weight: 700;
      text-decoration: none;
      transition: top 0.2s ease;
    }
    .skip-link:focus {
      top: 0;
    }

    /* === Topbar === */
    .topbar {
      background: var(--topbar-bg);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      color: var(--muted);
      font-size: 0.92rem;
    }

    .topbar-inner {
      max-width: var(--container);
      margin: 0 auto;
      padding: 10px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .topbar-left,
    .topbar-right {
      display: flex;
      align-items: center;
      gap: 14px;
      flex-wrap: wrap;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
    }

    .dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: color-mix(in srgb, var(--primary) 65%, transparent);
      flex: 0 0 auto;
    }

    .maplink {
      text-decoration: none;
      border-bottom: 1px dashed color-mix(in srgb, var(--primary) 35%, transparent);
      padding-bottom: 1px;
      transition: border-color 0.15s ease, color 0.15s ease, background-color 0.15s ease;
      border-radius: 8px;
    }
    .maplink:hover {
      border-color: color-mix(in srgb, var(--primary) 75%, transparent);
      color: var(--text);
      background: color-mix(in srgb, var(--primary) 6%, transparent);
    }
    .maplink:focus-visible {
      outline: 3px solid rgba(74, 163, 255, 0.45);
      outline-offset: 3px;
    }

    @media (max-width: 820px) {
      .topbar { display: none; }
    }

    /* === Menu bar (sticky) === */
    .menubar {
      position: sticky;
      top: 0;
      z-index: 30;
      background: var(--topbar-bg);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
    }

    .menubar-inner {
      max-width: var(--container);
      margin: 0 auto;
      padding: 12px 16px;
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      gap: 12px;
      min-height: var(--menu-h);
    }

    .brand {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      text-decoration: none;
    }
    .brand:focus-visible {
      outline: 3px solid rgba(74, 163, 255, 0.45);
      outline-offset: 3px;
      border-radius: 8px;
    }
    .brand img {
      width: auto;
      height: 52px;
      max-width: 90px;
      filter: drop-shadow(0 1px 1px rgba(0, 0, 0, 0.08));
    }

    .brand-text {
      display: grid;
      gap: 2px;
      line-height: 1.1;
    }
    .brand-name {
      font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
      font-weight: 900;
      letter-spacing: 0.2px;
      font-size: 1.1rem;
    }
    .brand-tagline {
      color: var(--muted);
      font-weight: 650;
      font-size: 0.92rem;
      white-space: nowrap;
    }

    /* Theme toggle */
    .theme-toggle {
      position: relative;
      display: inline-block;
      width: 58px;
      height: 30px;
    }
    .theme-toggle input {
      opacity: 0;
      width: 0;
      height: 0;
      position: absolute;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      inset: 0;
      background-color: rgba(0, 0, 0, 0.15);
      border: 1px solid var(--border);
      transition: background-color 0.25s ease;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 6px;
      box-shadow: var(--shadow-sm);
    }
    .slider::before {
      content: "";
      position: absolute;
      height: 22px;
      width: 22px;
      left: 3px;
      top: 3px;
      background-color: white;
      transition: transform 0.25s ease;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: rgba(46, 170, 95, 0.30);
    }
    input:checked + .slider::before {
      transform: translateX(28px);
    }
    .theme-toggle:focus-within .slider {
      outline: 3px solid rgba(74, 163, 255, 0.45);
      outline-offset: 3px;
    }
    .icon {
      font-size: 14px;
      opacity: 0.9;
      user-select: none;
    }

    /* Navigation */
    .nav-inner {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 10px;
      border: 1px solid var(--border);
      border-radius: 999px;
      background: var(--nav-bg);
      box-shadow: var(--shadow-sm);
      backdrop-filter: blur(10px);
      overflow-x: auto;
      scrollbar-width: none;
      justify-self: center;
    }
    .nav-inner::-webkit-scrollbar { display: none; }

    .nav-inner a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 8px 12px;
      border-radius: 999px;
      text-decoration: none;
      font-weight: 750;
      font-size: 0.95rem;
      color: var(--text);
      border: 1px solid transparent;
      transition: background-color 0.15s ease, transform 0.15s ease, border-color 0.15s ease;
      white-space: nowrap;
    }
    .nav-inner a:hover {
      background: color-mix(in srgb, var(--primary) 10%, transparent);
      border-color: color-mix(in srgb, var(--primary) 18%, transparent);
      transform: translateY(-1px);
    }
    .nav-inner a:focus-visible {
      outline: 3px solid rgba(74, 163, 255, 0.45);
      outline-offset: 3px;
    }
    .nav-inner a[aria-current="page"] {
      background: color-mix(in srgb, var(--primary) 12%, transparent);
      border-color: color-mix(in srgb, var(--primary) 22%, transparent);
    }

    /* Mobile hamburger */
    .menu-btn {
      display: none;
      border: 1px solid var(--border);
      background: var(--nav-bg);
      color: var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      font-weight: 850;
      box-shadow: var(--shadow-sm);
      cursor: pointer;
      font-size: inherit;
      font-family: inherit;
    }

    @media (max-width: 840px) {
      .menubar-inner {
        grid-template-columns: auto auto auto;
      }
      .nav-inner {
        display: none;
        grid-column: 1 / -1;
        flex-direction: column;
        align-items: stretch;
        border-radius: 16px;
        padding: 8px;
        margin-top: 10px;
      }
      .nav-inner.open { display: flex; }
      .nav-inner a {
        justify-content: flex-start;
        border-radius: 14px;
      }
      .menu-btn {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        justify-self: end;
      }
      .brand-tagline { display: none; }
      :root { --menu-h: 74px; }
    }

    @media (max-width: 520px) {
      .brand img { height: 46px; max-width: 80px; }
      :root { --menu-h: 70px; }
    }

    /* === Layout / cards === */
    main {
      flex: 1;
      width: 100%;
      display: flex;
      justify-content: center;
    }

    .page {
      width: 100%;
      max-width: var(--container);
      padding: 18px 16px 44px;
    }

    /* Scroll offset for sticky header */
    section[id] {
      scroll-margin-top: calc(var(--menu-h) + 16px);
    }

    .card {
      background: linear-gradient(180deg, color-mix(in srgb, var(--surface) 95%, transparent), color-mix(in srgb, var(--surface) 90%, transparent));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-sm);
      padding: 22px;
      margin: 14px 0;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -2px;
      background:
        radial-gradient(420px 220px at 15% 10%, rgba(11, 116, 209, 0.14), transparent 60%),
        radial-gradient(420px 220px at 85% 0%, rgba(46, 170, 95, 0.12), transparent 55%);
      pointer-events: none;
      opacity: 0.9;
    }
    .card > * { position: relative; }

    .card-head {
      text-align: center;
      margin-bottom: 12px;
    }
    .card-title {
      font-size: clamp(1.25rem, 2.2vw, 1.6rem);
      letter-spacing: 0.2px;
      font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
      margin: 0;
    }
    .card-subtitle {
      margin-top: 6px;
      color: var(--muted);
      font-size: 1rem;
    }

    .divider {
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--border), transparent);
      margin: 14px 0 6px;
    }

    .about-lines {
      display: grid;
      gap: 6px;
      justify-items: center;
      text-align: center;
      color: var(--muted);
    }

    .actions-row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 14px;
    }

    /* LinkedIn icon (inline SVG avoids external dependency on Wikimedia) */
    .linkedin-logo {
      width: 22px;
      height: 22px;
      transition: transform 0.15s ease, filter 0.15s ease;
    }
    .linkedin-link {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 44px;
      height: 44px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: var(--surface-2);
      box-shadow: var(--shadow-sm);
      text-decoration: none;
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }
    .linkedin-link:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }
    .linkedin-link:hover .linkedin-logo {
      transform: scale(1.05);
      filter: brightness(1.05);
    }
    .linkedin-link:focus-visible {
      outline: 3px solid rgba(74, 163, 255, 0.45);
      outline-offset: 3px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 16px;
      font-size: 0.98rem;
      font-weight: 750;
      color: #fff;
      background: var(--primary);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 14px;
      text-decoration: none;
      cursor: pointer;
      box-shadow: var(--shadow-sm);
      transition: transform 0.15s ease, box-shadow 0.15s ease, background-color 0.15s ease;
      margin-top: 8px;
      min-width: 180px;
    }
    .btn:hover {
      background: var(--primary-hover);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }
    .btn:focus-visible {
      outline: 3px solid rgba(74, 163, 255, 0.45);
      outline-offset: 3px;
    }
    .btn.primary { background: var(--success); }
    .btn.primary:hover { background: var(--success-hover); }
    .btn.small {
      min-width: unset;
      font-size: 0.92rem;
      padding: 9px 12px;
      border-radius: 12px;
      margin-top: 0;
    }

    .button-row {
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 6px;
    }

    .map-frame {
      width: 100%;
      height: 400px;
      border: 0;
      border-radius: 14px;
      overflow: hidden;
      box-shadow: var(--shadow-sm);
      margin-top: 14px;
    }

    @media (max-width: 520px) {
      .map-frame { height: 320px; }
      .btn { min-width: 160px; }
    }

    footer {
      border-top: 1px solid var(--border);
      background: var(--footer-bg);
      backdrop-filter: blur(10px);
      color: var(--muted);
      text-align: center;
      padding: 18px 12px;
    }
    footer p { font-size: 0.95rem; }
    footer a {
      text-decoration: underline;
      text-underline-offset: 3px;
    }
    footer a:focus-visible {
      outline: 3px solid rgba(74, 163, 255, 0.45);
      outline-offset: 3px;
    }

    /* Mobile menu overlay backdrop */
    .menu-backdrop {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 20;
    }
    .menu-backdrop.active { display: block; }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after { transition: none !important; animation: none !important; }
      html { scroll-behavior: auto !important; }
    }
  </style>
</head>

<body>
  <a class="skip-link" href="#main-content">Hopp til innhald</a>

  <!-- Topbar: contact details -->
  <div class="topbar" role="contentinfo" aria-label="Kontaktinformasjon">
    <div class="topbar-inner">
      <div class="topbar-left">
        <span class="chip">
          <span class="dot" aria-hidden="true"></span>
          Telefon: <strong><a href="tel:+4798836655">98 83 66 55</a></strong>
        </span>
        <span class="chip">
          <span class="dot" aria-hidden="true"></span>
          E-post: <strong><a href="mailto:osteopatiskjelbred@proton.me">osteopatiskjelbred@proton.me</a></strong>
        </span>
      </div>

      <div class="topbar-right">
        <span class="chip">
          <span class="dot" aria-hidden="true"></span>
          <a class="maplink"
             href="https://www.google.com/maps/search/?api=1&query=Sangereidlia+78,+4790+Lillesand"
             target="_blank" rel="noopener noreferrer"
             aria-label="Opne adresse i Google Maps (nytt vindauge)">
            Adresse: <strong>Sangereidlia 78, 4790 Lillesand</strong>
          </a>
        </span>
      </div>
    </div>
  </div>

  <!-- Menu bar (sticky) -->
  <header class="menubar">
    <div class="menubar-inner">
      <a class="brand" href="index.html" aria-label="Til framsida ‚Äì Osteopati Skjelbred">
        <img src="logo.gif" alt="" width="90" height="52" />
        <span class="brand-text">
          <span class="brand-name">Osteopati Skjelbred</span>
          <span class="brand-tagline">Biodynamisk osteopati &bull; Barneosteopati</span>
        </span>
      </a>

      <button class="menu-btn" id="menu-btn" type="button"
              aria-expanded="false" aria-controls="nav-inner">
        <span aria-hidden="true">‚ò∞</span> Meny
      </button>

      <nav class="nav-inner" id="nav-inner" aria-label="Hovudmeny">
        <a href="om-meg.html">Om meg</a>
        <a href="#contact">Kontakt</a>
        <a href="#location">Kor finn du meg?</a>
      </nav>

      <label class="theme-toggle" aria-label="Byt mellom lys og m√∏rk modus">
        <input type="checkbox" id="theme-switch" role="switch" />
        <span class="slider" aria-hidden="true">
          <span class="icon">‚òÄÔ∏è</span>
          <span class="icon">üåô</span>
        </span>
      </label>
    </div>
  </header>

  <!-- Backdrop for closing mobile menu -->
  <div class="menu-backdrop" id="menu-backdrop" aria-hidden="true"></div>

  <main id="main-content">
    <div class="page">

      <h1 class="visually-hidden">Osteopati Skjelbred ‚Äì Biodynamisk osteopati i Lillesand</h1>

      <section id="about" class="card" aria-labelledby="about-title">
        <div class="card-head">
          <h2 class="card-title" id="about-title">Ivar Otto Skjelbred</h2>
          <p class="card-subtitle">Osteopat D.O.</p>
        </div>
        <div class="divider" role="separator"></div>
        <div class="about-lines">
          <p>
            Medlem av
            <a href="https://osteopati.org"
               target="_blank"
               rel="noopener noreferrer">
              Norsk Osteopatforbund (MNOF)
            </a>
          </p>
        </div>
        <div class="actions-row">
          <a href="https://no.linkedin.com/in/dr-ivar-skjelbred-do-20038510"
             target="_blank" rel="noopener noreferrer"
             class="linkedin-link"
             aria-label="LinkedIn-profil for Ivar Otto Skjelbred (nytt vindauge)">
            <!-- Inline SVG ‚Äì no external dependency -->
            <svg class="linkedin-logo" viewBox="0 0 24 24" fill="#0A66C2" aria-hidden="true">
              <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
            </svg>
          </a>
          <a href="om-meg.html" class="btn small">Les meir om meg</a>
        </div>
      </section>

      <section id="contact" class="card" aria-labelledby="contact-title">
        <div class="card-head">
          <h2 class="card-title" id="contact-title">Kontakt</h2>
          <p class="card-subtitle">Ta kontakt for timebestilling eller sp√∏rsm√•l.</p>
        </div>
        <div class="divider" role="separator"></div>
        <div class="button-row">
          <a href="mailto:osteopatiskjelbred@proton.me" class="btn primary">
            ‚úâÔ∏è Send trygg e-post
          </a>
          <a href="tel:+4798836655" class="btn">
            üìû Ring
          </a>
        </div>
      </section>

      <section id="location" class="card" aria-labelledby="location-title">
        <div class="card-head">
          <h2 class="card-title" id="location-title">Kor finn du meg?</h2>
          <p class="card-subtitle">Sangereidlia 78, 4790 Lillesand</p>
        </div>
        <div class="divider" role="separator"></div>
        <iframe
          class="map-frame"
          title="Kart som viser Sangereidlia 78, 4790 Lillesand"
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1958.8391826365336!2d8.377259!3d58.250129!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x46380a7c9b91a02b%3A0x486c012a4d9d7a45!2sSangereidlia%2078%2C%204790%20Lillesand!5e0!3m2!1sen!2sno!4v1684596718539!5m2!1sen!2sno"
          allowfullscreen=""
          aria-hidden="false">
        </iframe>
      </section>

    </div>
  </main>

  <footer>
    <p>
      &copy; 2026 ‚Äî Ivar Otto Skjelbred ‚Äî Alle rettar reserverte ‚Äî Org.nr.
      <a href="https://w2.brreg.no/enhet/sok/detalj.jsp?orgnr=929240839"
         target="_blank" rel="noopener noreferrer">929240839</a> ‚Äî
      <a href="personvern.html">Personvern</a>
    </p>
  </footer>

  <!-- Visually hidden utility (for screen readers) -->
  <style>
    .visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
  </style>

  <script>
    (() => {
      'use strict';

      // === Theme handling ===
      const themeSwitch = document.getElementById('theme-switch');
      const root = document.documentElement;
      const saved = localStorage.getItem('theme');

      // Resolve initial theme: saved > system preference > light
      const prefersDark = matchMedia('(prefers-color-scheme: dark)').matches;
      const initialDark = saved ? saved === 'dark' : prefersDark;

      if (initialDark) {
        root.setAttribute('data-theme', 'dark');
        themeSwitch.checked = true;
      } else {
        root.setAttribute('data-theme', 'light');
      }

      themeSwitch.addEventListener('change', () => {
        const mode = themeSwitch.checked ? 'dark' : 'light';
        root.setAttribute('data-theme', mode);
        localStorage.setItem('theme', mode);
      });

      // Follow system changes if user hasn't manually set a preference
      matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
        if (localStorage.getItem('theme')) return; // user overrode
        const mode = e.matches ? 'dark' : 'light';
        root.setAttribute('data-theme', mode);
        themeSwitch.checked = e.matches;
      });

      // === Mobile menu ===
      const menuBtn = document.getElementById('menu-btn');
      const navInner = document.getElementById('nav-inner');
      const backdrop = document.getElementById('menu-backdrop');

      function closeMenu() {
        navInner.classList.remove('open');
        backdrop.classList.remove('active');
        menuBtn.setAttribute('aria-expanded', 'false');
      }

      function toggleMenu() {
        const willOpen = !navInner.classList.contains('open');
        navInner.classList.toggle('open', willOpen);
        backdrop.classList.toggle('active', willOpen);
        menuBtn.setAttribute('aria-expanded', String(willOpen));
        if (willOpen) {
          // Focus first link for keyboard users
          navInner.querySelector('a')?.focus();
        }
      }

      menuBtn.addEventListener('click', toggleMenu);
      backdrop.addEventListener('click', closeMenu);

      // Close on nav link click (mobile)
      navInner.querySelectorAll('a').forEach(a => {
        a.addEventListener('click', () => {
          if (matchMedia('(max-width: 840px)').matches) closeMenu();
        });
      });

      // Close on Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && navInner.classList.contains('open')) {
          closeMenu();
          menuBtn.focus();
        }
      });
    })();
  </script>
</body>
</html>
